<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Image Viewer</title>
<style>
:root{--bg:#0b0f14;--ink:#e6eef8;--muted:#9bb1c7;--border:#223041;--panel:#0f172a}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
.toolbar{position:fixed;top:10px;left:50%;transform:translateX(-50%);display:flex;gap:8px;background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:6px 10px;z-index:2}
.btn{background:var(--panel);border:1px solid var(--border);color:var(--ink);padding:6px 10px;border-radius:10px;cursor:pointer}
.btn:hover{border-color:#60a5fa}
#stage{position:absolute;inset:0;overflow:auto;cursor:grab}
#stage:active{cursor:grabbing}
#img{transform-origin:0 0;image-rendering:auto;max-width:none;max-height:none;display:block}
.help{position:fixed;bottom:10px;left:50%;transform:translateX(-50%);color:var(--muted);font-size:12px;background:var(--panel);border:1px solid var(--border);padding:6px 10px;border-radius:10px}
</style>
</head>
<body>
<div class="toolbar">
  <button class="btn" id="zoomOut">−</button>
  <button class="btn" id="zoomIn">+</button>
  <button class="btn" id="fit">Fit</button>
  <button class="btn" id="reset">100%</button>
</div>
<div id="stage"><img id="img" alt=""></div>
<div class="help">Scroll to zoom · Drag to pan · Double‑click to fit</div>
<script>
(function(){
  const params = new URLSearchParams(location.search);
  const src = params.get('src');
  const alt = params.get('alt') || 'image';
  const img = document.getElementById('img');
  const stage = document.getElementById('stage');
  img.src = src; img.alt = alt;

  let scale = 1;
  let tx = 0, ty = 0;
  let dragging = false, sx=0, sy=0;

  function apply(){ img.style.transform = `translate(${tx}px, ${ty}px) scale(${scale})`; }
  function fit(){
    const vw = stage.clientWidth, vh = stage.clientHeight;
    const iw = img.naturalWidth || img.width, ih = img.naturalHeight || img.height;
    if(!iw || !ih) return;
    scale = Math.min(vw/iw, vh/ih);
    if(!isFinite(scale) || scale <= 0) scale = 1;
    tx = ty = 0;
    apply();
  }
  function reset(){ scale = 1; tx = ty = 0; apply(); }
  function zoom(delta, cx, cy){
    const old = scale;
    const factor = delta > 0 ? 0.9 : 1.1;
    scale = Math.max(0.05, Math.min(20, scale * factor));
    const rect = stage.getBoundingClientRect();
    const x = (cx - rect.left - tx) / old;
    const y = (cy - rect.top - ty) / old;
    tx = cx - rect.left - x * scale;
    ty = cy - rect.top - y * scale;
    apply();
  }

  stage.addEventListener('wheel', e => { e.preventDefault(); zoom(e.deltaY, e.clientX, e.clientY); }, {passive:false});
  stage.addEventListener('mousedown', e => { dragging = true; sx=e.clientX; sy=e.clientY; });
  window.addEventListener('mouseup', ()=> dragging=false);
  window.addEventListener('mousemove', e => { if(!dragging) return; tx += (e.clientX - sx); ty += (e.clientY - sy); sx=e.clientX; sy=e.clientY; apply(); });
  stage.addEventListener('dblclick', ()=> fit());

  document.getElementById('zoomIn').onclick = ()=> zoom(-1, stage.clientWidth/2, stage.clientHeight/2);
  document.getElementById('zoomOut').onclick = ()=> zoom(+1, stage.clientWidth/2, stage.clientHeight/2);
  document.getElementById('fit').onclick = fit;
  document.getElementById('reset').onclick = reset;

  img.addEventListener('load', fit);
  window.addEventListener('resize', fit);
})();
</script>
</body>
</html>
